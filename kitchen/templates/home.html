{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
<h1>FridgeToFeast</h1>
<p>Generate recipes with AI.</p>
<form method="post">
  {% csrf_token %}
  {{ form }}
  <input type="submit" class="btn btn-primary" value="Filter">
</form>

<!-- Botón para generar receta -->
<button id="generate-recipe-btn" class="btn btn-success">Generate Recipe</button>


<!-- Contenedor para mostrar la receta generada -->
<div id="recipe-output" class="mt-3">
  <!-- La receta se mostrará aquí -->
</div>

<!-- CARD SECTION -->
<div id="card-section" class="card card-body mt-3">
  <h2 class="text-center">Ingredients List</h2>
  {% if ingredients %}
  <div class="list-group">
    {% for ingredient in ingredients %}
    <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
      <div>
        <h5 class="mb-1">{{ ingredient.name }}</h5>
        <small>Quantity: {{ ingredient.quantity }} - Unit: {{ ingredient.unit }}</small>
      </div>
      <form action="{% url 'delete_ingredient' ingredient.id %}" method="POST">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
      </form>
      <form action="{% url 'view_ingredient' ingredient.id %}" method="GET">
        <button type="submit" class="btn btn-warning btn-sm">View</button>
      </form>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-center text-muted">No ingredients added yet.</p>
  {% endif %}
</div>
{% endblock %}


{% block scripts %}
<script type="text/javascript">
    // Esta variable ahora se define dentro del bloque 'scripts' para asegurar su correcta carga
    var generateRecipeUrl = "{% url 'recipe:generate_recipe_view' %}";
</script>
<script src="{% static 'recipe/recipe_generator.js' %}" defer></script>
{% endblock %}